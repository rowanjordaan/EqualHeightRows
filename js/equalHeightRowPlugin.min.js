!function(h){h.fn.equalHeightRows=function(t){var e=h(this),i={settings:{}};i.settings=h.extend({onInit:null,onResize:null,itemSelector:".item",innerSelectors:null,wrapRows:!1,resizeTimeout:200,throttleTimeout:300,bindOnResize:!0,reinitImage:"all"},t);var l=i.settings,u=function(t,e){h(t).attr("data-lastcall",parseFloat(h(t).css("width")));var n={};n.selector=h(t),n.items=n.selector.find(l.itemSelector),n.itemAmount=n.items.length,n.rowsDom=[],n.rowsHeight=[];var r=1,s=parseFloat(n.selector.css("width")),a=0;return(l.wrapRows||0<h(n.selector).find('[data-type="row"]:nth-child(1)').length)&&h(n.selector).find('[data-type="row"]').contents().unwrap(),h(n.items).css("height","auto"),n.rowsDom["row"+r]=[],n.rowsHeight["row"+r]=0,n.items.each(function(t,e){if(a=parseFloat(a+parseFloat(h(e).css("width"))),s<a&&(r++,a=parseFloat(h(e).css("width")),n.rowsDom["row"+r]=[],n.rowsHeight["row"+r]=0),n.rowsDom["row"+r].push(e),parseInt(t+1)>=n.itemAmount||parseFloat(a+parseFloat(h(e).next().css("width")))>s){var o=h(n.rowsDom["row"+r]);if(null!=l.innerSelectors){var i=l.innerSelectors.split(",");h.each(i,function(t,e){var i,n;i=o.find(e),n=0,i.css({height:"auto"}),1<i.length&&(i.each(function(){var t=h(this).outerHeight();n=n<=t?t:n}),i.css({height:n+"px"}))})}o.each(function(t,e){n.rowsHeight["row"+r]=parseFloat(h(e).css("height"))>n.rowsHeight["row"+r]?parseFloat(h(e).css("height")):n.rowsHeight["row"+r]}),o.css("height",n.rowsHeight["row"+r]+"px"),l.wrapRows&&o.wrapAll('<div class="'+l.wrapRows+" "+t+'" data-type="row"></div>')}}),h.isFunction(e)&&e(n),n};return i.execute=function(i){var n={};return i=void 0!==i&&i,e.each(function(t,e){(!1===i||!1!==i&&h(e).is(i))&&(n[t]=u(h(e)))}),n},this.each(function(t,o){var e,i=o,n=function(){if(h(i).attr("data-lastcall")!=parseFloat(h(i).css("width"))){var t=u(o);h.isFunction(l.onResize)&&l.onResize(t)}},r=0;if(l.bindOnResize&&h(window).on("resize",function(){l.throttleTimeout&&l.resizeTimeout&&(r<=0?(r++,n()):1===r&&(r++,setTimeout(function(){r=0},l.throttleTimeout))),l.resizeTimeout?(clearTimeout(e),e=setTimeout(function(){n()},l.resizeTimeout)):n()}),l.reinitImage){reinitImage=(l.reinitImage,l.reinitImage);var s=h(o).find("img").length,a=0;h(o).find("img").each(function(t,e){var i=new Image,n=function(t){var e;a++,h(t).attr("loaded",!0),"individual"==reinitImage&&(e=t,u(o,function(){setTimeout(function(){h(e).attr("imagereinit",!0)},50)}),s<=a&&h(o).attr("imagereinit",!0)),"all"==reinitImage&&s<=a&&(h(o).attr("loadedImages",!0),u(o,function(){setTimeout(function(){h(o).attr("imagereinit",!0)},10)}),h(o).find("img").attr("imagereinit",!0))};i.onload=function(){n(e)},i.onerror=function(){console.error("Cannot load image("+t+"): "+h(e).attr("src")),n(e)},i.src=h(this).attr("src")})}var c;return c=u(o),h.isFunction(l.onInit)&&l.onInit(c),c}),i}}(jQuery);
