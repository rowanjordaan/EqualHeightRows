!function(t){t.fn.equalHeightRows=function(e){var n=t.extend({onInit:null,onResize:null,itemSelector:".item",innerSelectors:null,wrapRows:!1},e),i=t(this),o={},r=function(e){var n=0;e.css({height:"auto"}),e.length>1&&(e.each(function(){var e=t(this).outerHeight();n=e>=n?e:n}),e.css({height:n+"px"}))},a=function(e){var i={};i.selector=t(e),i.items=i.selector.find(n.itemSelector),i.itemAmount=i.items.length,i.rowsData={},i.rowsItems={};var o=0,a=1,s=0,c=i.selector.width();return n.wrapRows&&t(i.selector).find('[data-type="row"]').contents().unwrap(),i.items.each(function(e,r){i.rowsData["row"+a]={lastItem:e+1};var l,w;if(l=parseFloat(t(r).css("width")),w=parseFloat(i.selector.find(n.itemSelector+":nth-child("+(e+2)+")").css("width")),(s+=l)>=c||e+1>=i.itemAmount||Math.floor(s+w)>c){var u=0==o?i.rowsData["row"+a].lastItem:i.rowsData["row"+a].lastItem-i.rowsData["row"+o].lastItem,h=i.rowsData["row"+a].lastItem-u+1;i.rowsData["row"+a].firstItem=h,i.rowsItems["row"+a]=i.items.filter(n.itemSelector+":nth-child(n+"+h+"):nth-child(-n+"+i.rowsData["row"+a].lastItem+")"),o=a,a++,s=0}}),t.each(i.rowsItems,function(e,i){if(r(i),n.wrapRows&&i.wrapAll('<div class="'+n.wrapRows+" "+e+'" data-type="row"></div>'),null!=n.innerSelectors){var o=n.innerSelectors.split(",");t.each(o,function(t,e){r(i.find(e)),r(i)})}}),i};return o.execute=function(e){var n={};return e=void 0!==e&&e,i.each(function(i,o){(!1===e||!1!==e&&t(o).is(e))&&(n[i]=a(t(o)))}),n},this.each(function(e,i){var o={data:{}};t(window).on("resize",function(){a(i),t.isFunction(n.onResize)&&n.onResize(o)}),o.Initialize=function(){o.data=a(i),t.isFunction(n.onInit)&&n.onInit(o)},o.Initialize()}),o}}(jQuery);
