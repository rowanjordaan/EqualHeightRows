!function(t){t.fn.equalHeightRows=function(e){var o=t.extend({onInit:null,onResize:null,itemSelector:".item",innerSelectors:null},e),r=t(this),i={},n=function(e){var o=0;e.css({height:"auto"}),e.each(function(){var e=t(this).outerHeight();o=e>=o?e:o}),e.css({height:o+"px"})};return _execute=function(e){$selector=t(e),$items=$selector.find(o.itemSelector);var r=$selector.width(),i={};return i.itemAmount=$items.length,i.rowsData={},i.rowspreviousRow=0,i.rowscurrentRow=1,i.rowsitemWidthCount=0,$items.each(function(e,n){if(i.rowsData["row"+i.rowscurrentRow]={},i.rowsData["row"+i.rowscurrentRow].lastItem=e+1,w=parseFloat(t(n).css("width")),u=parseFloat($selector.find(o.itemSelector+":nth-child("+(e+2)+")").css("width")),i.rowsitemWidthCount=i.rowsitemWidthCount+w,i.rowsitemWidthCount>=r||e+1>=i.itemAmount||Math.floor(i.rowsitemWidthCount+u)>r){var s=0==i.rowspreviousRow?i.rowsData["row"+i.rowscurrentRow].lastItem:i.rowsData["row"+i.rowscurrentRow].lastItem-i.rowsData["row"+i.rowspreviousRow].lastItem,c=i.rowsData["row"+i.rowscurrentRow].lastItem-s+1;i.rowsData["row"+i.rowscurrentRow].firstItem=c,i.rowspreviousRow=i.rowscurrentRow,i.rowscurrentRow++,i.rowsitemWidthCount=0}var w,u}),t.each(i.rowsData,function(e,r){var i=$items.filter(o.itemSelector+":nth-child(n+"+r.firstItem+"):nth-child(-n+"+r.lastItem+")");if(n(i),null!=o.innerSelectors){var s=o.innerSelectors.split(",");t.each(s,function(t,e){n(i.find(e)),n(i)})}}),i},i.execute=function(){var e={};return r.each(function(o,r){e[o]=_execute(t(r))}),e},this.each(function(e,r){var i={};i.selector=t(r),i.items=i.selector.find(o.itemSelector),t(window).on("resize",function(){_execute(r),t.isFunction(o.onResize)&&o.onResize(i)}),i.Initialize=function(){_execute(r),t.isFunction(o.onInit)&&o.onInit(i)},i.Initialize()}),i}}(jQuery);
