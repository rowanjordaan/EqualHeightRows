!function(t){t.fn.equalHeightRows=function(e){var i=t.extend({onInit:null,onResize:null,itemSelector:".item",innerSelectors:null,wrapRows:!1,resizeTimeout:150,stoppedResizingresizeTimeout:150},e),s=t(this),n={settings:{}};n.settings.wrapRows=i.wrapRows,n.settings.resizeTimeout=i.resizeTimeout,n.settings.stoppedResizingresizeTimeout=i.stoppedResizingresizeTimeout;var o=function(e){var i=0;e.css({height:"auto"}),e.length>1&&(e.each(function(){var e=t(this).outerHeight();i=e>=i?e:i}),e.css({height:i+"px"}))},r=function(e){var s={};s.selector=t(e),s.items=s.selector.find(i.itemSelector),s.itemAmount=s.items.length,s.rowsData={},s.rowsItems={};var r=0,a=1,u=0,c=s.selector.width();return(n.settings.wrapRows||t(s.selector).find('[data-type="row"]:nth-child(1)').length>0)&&t(s.selector).find('[data-type="row"]').contents().unwrap(),s.items.each(function(e,n){s.rowsData["row"+a]={lastItem:e+1};var o,l;if(o=parseFloat(t(n).css("width")),l=parseFloat(s.selector.find(i.itemSelector+":nth-child("+(e+2)+")").css("width")),(u+=o)>=c||e+1>=s.itemAmount||Math.floor(u+l)>c){var w=0==r?s.rowsData["row"+a].lastItem:s.rowsData["row"+a].lastItem-s.rowsData["row"+r].lastItem,m=s.rowsData["row"+a].lastItem-w+1;s.rowsData["row"+a].firstItem=m,s.rowsItems["row"+a]=s.items.filter(i.itemSelector+":nth-child(n+"+m+"):nth-child(-n+"+s.rowsData["row"+a].lastItem+")"),r=a,a++,u=0}}),t.each(s.rowsItems,function(e,s){if(o(s),n.settings.wrapRows&&s.wrapAll('<div class="'+n.settings.wrapRows+" "+e+'" data-type="row"></div>'),null!=i.innerSelectors){var r=i.innerSelectors.split(",");t.each(r,function(t,e){o(s.find(e)),o(s)})}}),s};return n.execute=function(e){var i={};return e=void 0!==e&&e,s.each(function(s,n){(!1===e||!1!==e&&t(n).is(e))&&(i[s]=r(t(n)))}),i},this.each(function(e,s){var o,a={data:{}},u=!1,c=!1,l=function(){r(s),t.isFunction(i.onResize)&&i.onResize(a)};return t(window).on("resize",function(){var t;return clearTimeout(o),n.settings.resizeTimeout>0&&!1!==n.settings.resizeTimeout?!1===u?(l(),u=!0,!0):(!1===c&&(t=setTimeout(function(){return u=!1,c=!1,l(),!0},n.settings.resizeTimeout)),c=!0,o=setTimeout(function(){return l(),clearTimeout(t),!0},n.settings.stoppedResizingresizeTimeout),!1):(l(),!0)}),a.Initialize=function(){a.data=r(s),t.isFunction(i.onInit)&&i.onInit(a)},a.Initialize()}),n}}(jQuery);
