!function(t){t.fn.equalHeightRows=function(e){var n=t.extend({onInit:null,onResize:null,itemSelector:".item",innerSelectors:null},e);this.each(function(e,o){var i=this,r=t(this),s=r.find(n.itemSelector),c={element:i,onInit:n.onInit,onResize:n.onResize,itemSelector:n.itemSelector,innerSelectors:null!=n.innerSelectors?n.innerSelectors.split(","):n.innerSelectors};i.execute=function(){var e=r.width(),o={};o.itemAmount=s.length,o.rows={},o.previousRow=0,o.currentRow=1,o.itemWidthCount=0,s.each(function(i,s){if(o.rows["row"+o.currentRow]={},o.rows["row"+o.currentRow].lastItem=i+1,l=parseFloat(t(s).css("width")),w=parseFloat(r.find(n.itemSelector+":nth-child("+(i+2)+")").css("width")),o.itemWidthCount=o.itemWidthCount+l,o.itemWidthCount>=e||i+1>=o.itemAmount||Math.floor(o.itemWidthCount+w)>e){var c=0==o.previousRow?o.rows["row"+o.currentRow].lastItem:o.rows["row"+o.currentRow].lastItem-o.rows["row"+o.previousRow].lastItem,u=o.rows["row"+o.currentRow].lastItem-c+1;o.rows["row"+o.currentRow].firstItem=u,o.previousRow=o.currentRow,o.currentRow++,o.itemWidthCount=0}var l,w});var i=function(e){var n=0;e.css({height:"auto"}),e.each(function(){var e=t(this).outerHeight();n=e>=n?e:n}),e.css({height:n+"px"})};t.each(o.rows,function(e,o){var s=r.find(n.itemSelector+":nth-child(n+"+o.firstItem+"):nth-child(-n+"+o.lastItem+")");if(i(s),null!=n.innerSelectors){var c=n.innerSelectors.split(",");t.each(c,function(t,e){i(s.find(e)),i(s)})}}),c.rows=o.rows,c.itemAmount=o.itemAmount,c.rowAmount=o.currentRow-1},t(window).on("resize",function(){i.execute(),t.isFunction(n.onResize)&&n.onResize(c)}),i.Initialize=function(){i.execute(),t.isFunction(n.onInit)&&n.onInit(c)},i.Initialize()})}}(jQuery);
