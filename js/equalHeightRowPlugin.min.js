!function(u){u.fn.equalHeightRows=function(t){var e=u(this),i={settings:{}};i.settings=u.extend({onInit:null,onResize:null,itemSelector:".item",innerSelectors:null,wrapRows:!1,resizeTimeout:150,bindOnResize:!0,reinitImage:"all"},t);var c=i.settings,l=function(t,e){u(t).attr("data-lastcall",parseFloat(u(t).css("width")));var n={};n.selector=u(t),n.items=n.selector.find(c.itemSelector),n.itemAmount=n.items.length,n.rowsDom=[],n.rowsHeight=[];var o=1,s=parseFloat(n.selector.css("width")),a=0;return(c.wrapRows||0<u(n.selector).find('[data-type="row"]:nth-child(1)').length)&&u(n.selector).find('[data-type="row"]').contents().unwrap(),u(n.items).css("height","auto"),n.rowsDom["row"+o]=[],n.rowsHeight["row"+o]=0,n.items.each(function(t,e){if(a=parseFloat(a+parseFloat(u(e).css("width"))),s<a&&(o++,a=parseFloat(u(e).css("width")),n.rowsDom["row"+o]=[],n.rowsHeight["row"+o]=0),n.rowsDom["row"+o].push(e),parseInt(t+1)>=n.itemAmount||parseFloat(a+parseFloat(u(e).next().css("width")))>s){var r=u(n.rowsDom["row"+o]);if(null!=c.innerSelectors){var i=c.innerSelectors.split(",");u.each(i,function(t,e){var i,n;i=r.find(e),n=0,i.css({height:"auto"}),1<i.length&&(i.each(function(){var t=u(this).outerHeight();n=n<=t?t:n}),i.css({height:n+"px"}))})}r.each(function(t,e){n.rowsHeight["row"+o]=parseFloat(u(e).css("height"))>n.rowsHeight["row"+o]?parseFloat(u(e).css("height")):n.rowsHeight["row"+o]}),r.css("height",n.rowsHeight["row"+o]+"px"),c.wrapRows&&r.wrapAll('<div class="'+c.wrapRows+" "+t+'" data-type="row"></div>')}}),u.isFunction(e)&&e(n),n};return i.execute=function(i){var n={};return i=void 0!==i&&i,e.each(function(t,e){(!1===i||!1!==i&&u(e).is(i))&&(n[t]=l(u(e)))}),n},this.each(function(t,r){var e,i=r,n=function(){if(u(i).attr("data-lastcall")!=parseFloat(u(i).css("width"))){var t=l(r);u.isFunction(c.onResize)&&c.onResize(t)}};if(c.bindOnResize&&u(window).on("resize",function(){return c.resizeTimeout?(clearTimeout(e),e=setTimeout(function(){n()},c.resizeTimeout)):n(),!0}),c.reinitImage){reinitImage=(c.reinitImage,c.reinitImage);var o=u(r).find("img").length,s=0;u(r).find("img").each(function(t,e){var i=new Image,n=function(t){var e;s++,u(t).attr("loaded",!0),"individual"==reinitImage&&(e=t,l(r,function(){setTimeout(function(){u(e).attr("imagereinit",!0)},50)}),o<=s&&u(r).attr("imagereinit",!0)),"all"==reinitImage&&o<=s&&(u(r).attr("loadedImages",!0),l(r,function(){setTimeout(function(){u(r).attr("imagereinit",!0)},10)}),u(r).find("img").attr("imagereinit",!0))};i.onload=function(){n(e)},i.onerror=function(){console.error("Cannot load image("+t+"): "+u(e).attr("src")),n(e)},i.src=u(this).attr("src")})}var a;return a=l(r),u.isFunction(c.onInit)&&c.onInit(a),a}),i}}(jQuery);
