!function(t){t.fn.equalHeightRows=function(e){var i=t.extend({onInit:null,onResize:null,itemSelector:".item",innerSelectors:null},e),n=t(this),o={},r=function(e){var i=0;e.css({height:"auto"}),e.each(function(){var e=t(this).outerHeight();i=e>=i?e:i}),e.css({height:i+"px"})};return _execute=function(e){var n={};n.selector=t(e),n.items=n.selector.find(i.itemSelector),n.itemAmount=n.items.length,n.rowsData={};var o=0,a=1,s=0,c=n.selector.width();return n.items.each(function(e,r){if(n.rowsData["row"+a]={},n.rowsData["row"+a].lastItem=e+1,h=parseFloat(t(r).css("width")),f=parseFloat(n.selector.find(i.itemSelector+":nth-child("+(e+2)+")").css("width")),(s+=h)>=c||e+1>=n.itemAmount||Math.floor(s+f)>c){var l=0==o?n.rowsData["row"+a].lastItem:n.rowsData["row"+a].lastItem-n.rowsData["row"+o].lastItem,u=n.rowsData["row"+a].lastItem-l+1;n.rowsData["row"+a].firstItem=u,o=a,a++,s=0}var h,f}),t.each(n.rowsData,function(e,o){var a=n.items.filter(i.itemSelector+":nth-child(n+"+o.firstItem+"):nth-child(-n+"+o.lastItem+")");if(r(a),null!=i.innerSelectors){var s=i.innerSelectors.split(",");t.each(s,function(t,e){r(a.find(e)),r(a)})}}),n},o.execute=function(e,i){var o={};return e=void 0!==e&&e,i=void 0!==i&&i,n.each(function(n,r){(!1===e&&!1===i||e===n&&(!1===i||t(r).is(i))||!1!==i&&t(r).is(i)&&(!1===e||e===n))&&(o[n]=_execute(t(r)))}),o},this.each(function(e,n){var o={data:{}};t(window).on("resize",function(){_execute(n),t.isFunction(i.onResize)&&i.onResize(o)}),o.Initialize=function(){o.data=_execute(n),t.isFunction(i.onInit)&&i.onInit(o)},o.Initialize()}),o}}(jQuery);
